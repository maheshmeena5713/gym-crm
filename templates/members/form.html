{% extends "base.html" %}
{% block page_title %}{{ form_title|default:"Add Member" }}{% endblock %}
{% block page_subtitle %}{{ form_subtitle|default:"Add a new member to your gym" }}{% endblock %}
{% block title %}{{ form_title|default:"Add Member" }}{% endblock %}

{% block breadcrumb %}
<nav class="flex items-center gap-2 text-sm mb-6">
    <a href="{% url 'frontend:member-list' %}" class="text-slate-500 hover:text-slate-300">Members</a>
    <svg class="w-4 h-4 text-slate-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
    <span class="text-slate-300">{{ form_title|default:"Add Member" }}</span>
</nav>
{% endblock %}

{% block content %}
<form method="post" class="max-w-3xl">
    {% csrf_token %}
    {% if form.errors %}
    <div class="bg-rose-500/10 border border-rose-500/20 rounded-xl p-4 mb-6">
        <h4 class="text-sm font-medium text-rose-400 mb-2">Please fix the errors:</h4>
        <ul class="list-disc list-inside text-sm text-rose-300 space-y-1">
            {% for field, errors in form.errors.items %}{% for error in errors %}<li>{{ field|title }}: {{ error }}</li>{% endfor %}{% endfor %}
        </ul>
    </div>
    {% endif %}

    <!-- Personal Info -->
    <div class="bg-slate-900 border border-slate-800 rounded-xl p-5 mb-4">
        <h3 class="text-sm font-semibold text-slate-400 uppercase tracking-wider mb-4">Personal Information</h3>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <div class="sm:col-span-2">
                <label class="block text-sm font-medium text-slate-300 mb-1">Full Name *</label>
                <input type="text" name="name" value="{{ form.name.value|default:'' }}" required
                       class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-sm text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-brand-500" placeholder="Raj Patel">
            </div>
            <div>
                <label class="block text-sm font-medium text-slate-300 mb-1">Phone *</label>
                <input type="tel" name="phone" value="{{ form.phone.value|default:'' }}" required maxlength="15"
                       class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-sm text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-brand-500" placeholder="9876543210">
            </div>
            <div>
                <label class="block text-sm font-medium text-slate-300 mb-1">Email</label>
                <input type="email" name="email" value="{{ form.email.value|default:'' }}"
                       class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-sm text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-brand-500" placeholder="raj@example.com">
            </div>
            <div>
                <label class="block text-sm font-medium text-slate-300 mb-1">Gender</label>
                <select name="gender" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-sm text-white focus:outline-none focus:ring-2 focus:ring-brand-500">
                    <option value="">Select</option>
                    <option value="male" {% if form.gender.value == 'male' %}selected{% endif %}>Male</option>
                    <option value="female" {% if form.gender.value == 'female' %}selected{% endif %}>Female</option>
                    <option value="other" {% if form.gender.value == 'other' %}selected{% endif %}>Other</option>
                </select>
            </div>
            <div>
                <label class="block text-sm font-medium text-slate-300 mb-1">Date of Birth</label>
                <input type="date" name="date_of_birth" value="{{ form.date_of_birth.value|default:'' }}"
                       class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-sm text-white focus:outline-none focus:ring-2 focus:ring-brand-500">
            </div>
        </div>
    </div>

    <!-- Fitness -->
    <div class="bg-slate-900 border border-slate-800 rounded-xl p-5 mb-4">
        <h3 class="text-sm font-semibold text-slate-400 uppercase tracking-wider mb-4">Fitness Profile</h3>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <div>
                <label class="block text-sm font-medium text-slate-300 mb-1">Goal *</label>
                <select name="goal" required class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-sm text-white focus:outline-none focus:ring-2 focus:ring-brand-500">
                    <option value="">Select Goal</option>
                    <option value="weight_loss" {% if form.goal.value == 'weight_loss' %}selected{% endif %}>Weight Loss</option>
                    <option value="muscle_gain" {% if form.goal.value == 'muscle_gain' %}selected{% endif %}>Muscle Gain</option>
                    <option value="general_fitness" {% if form.goal.value == 'general_fitness' %}selected{% endif %}>General Fitness</option>
                    <option value="strength" {% if form.goal.value == 'strength' %}selected{% endif %}>Strength</option>
                    <option value="flexibility" {% if form.goal.value == 'flexibility' %}selected{% endif %}>Flexibility</option>
                    <option value="sports" {% if form.goal.value == 'sports' %}selected{% endif %}>Sports</option>
                    <option value="rehab" {% if form.goal.value == 'rehab' %}selected{% endif %}>Rehab</option>
                </select>
            </div>
            <div>
                <label class="block text-sm font-medium text-slate-300 mb-1">Experience</label>
                <select name="experience_level" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-sm text-white focus:outline-none focus:ring-2 focus:ring-brand-500">
                    <option value="beginner" {% if form.experience_level.value == 'beginner' %}selected{% endif %}>Beginner</option>
                    <option value="intermediate" {% if form.experience_level.value == 'intermediate' %}selected{% endif %}>Intermediate</option>
                    <option value="advanced" {% if form.experience_level.value == 'advanced' %}selected{% endif %}>Advanced</option>
                </select>
            </div>
            <div>
                <label class="block text-sm font-medium text-slate-300 mb-1">Height (cm)</label>
                <input type="number" name="height_cm" value="{{ form.height_cm.value|default:'' }}" step="0.1"
                       class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-sm text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-brand-500" placeholder="175">
            </div>
            <div>
                <label class="block text-sm font-medium text-slate-300 mb-1">Weight (kg)</label>
                <input type="number" name="weight_kg" value="{{ form.weight_kg.value|default:'' }}" step="0.1"
                       class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-sm text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-brand-500" placeholder="72">
            </div>
            <div>
                <label class="block text-sm font-medium text-slate-300 mb-1">Diet</label>
                <select name="dietary_preference" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-sm text-white focus:outline-none focus:ring-2 focus:ring-brand-500">
                    <option value="veg" {% if form.dietary_preference.value == 'veg' %}selected{% endif %}>Veg</option>
                    <option value="non_veg" {% if form.dietary_preference.value == 'non_veg' %}selected{% endif %}>Non-Veg</option>
                    <option value="eggetarian" {% if form.dietary_preference.value == 'eggetarian' %}selected{% endif %}>Eggetarian</option>
                    <option value="vegan" {% if form.dietary_preference.value == 'vegan' %}selected{% endif %}>Vegan</option>
                </select>
            </div>
            <div>
                <label class="block text-sm font-medium text-slate-300 mb-1">Medical Conditions</label>
                <input type="text" name="medical_conditions" value="{{ form.medical_conditions.value|default:'' }}"
                       class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-sm text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-brand-500" placeholder="None">
            </div>
        </div>
    </div>

    <!-- Membership -->
    <div class="bg-slate-900 border border-slate-800 rounded-xl p-5 mb-4">
        <h3 class="text-sm font-semibold text-slate-400 uppercase tracking-wider mb-4">Membership</h3>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <div>
                <label class="block text-sm font-medium text-slate-300 mb-1">Plan</label>
                <select name="membership_plan" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-sm text-white focus:outline-none focus:ring-2 focus:ring-brand-500">
                    <option value="">No Plan</option>
                    {% for plan in plans %}<option value="{{ plan.id }}" {% if form.membership_plan.value|stringformat:"s" == plan.id|stringformat:"s" %}selected{% endif %}>{{ plan.name }} (₹{{ plan.price }})</option>{% endfor %}
                </select>
            </div>
            <div>
                <label class="block text-sm font-medium text-slate-300 mb-1">Trainer</label>
                <select name="assigned_trainer" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-sm text-white focus:outline-none focus:ring-2 focus:ring-brand-500">
                    <option value="">No Trainer</option>
                    {% for trainer in trainers %}<option value="{{ trainer.id }}" {% if form.assigned_trainer.value|stringformat:"s" == trainer.id|stringformat:"s" %}selected{% endif %}>{{ trainer.name }}</option>{% endfor %}
                </select>
            </div>
            <div>
                <label class="block text-sm font-medium text-slate-300 mb-1">Join Date</label>
                <input type="date" name="join_date" value="{{ form.join_date.value|default:today }}"
                       class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-sm text-white focus:outline-none focus:ring-2 focus:ring-brand-500">
            </div>
            <div>
                <label class="block text-sm font-medium text-slate-300 mb-1">Expiry Date</label>
                <input type="date" name="membership_expiry" value="{{ form.membership_expiry.value|default:'' }}"
                       class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-sm text-white focus:outline-none focus:ring-2 focus:ring-brand-500">
            </div>
            <div>
                <label class="block text-sm font-medium text-slate-300 mb-1">Amount Paid (₹)</label>
                <input type="number" name="amount_paid" value="{{ form.amount_paid.value|default:'0' }}" step="0.01"
                       class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-sm text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-brand-500" placeholder="5000">
            </div>
            <div>
                <label class="block text-sm font-medium text-slate-300 mb-1">Status</label>
                <select name="status" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2.5 text-sm text-white focus:outline-none focus:ring-2 focus:ring-brand-500">
                    <option value="active" {% if form.status.value == 'active' %}selected{% endif %}>Active</option>
                    <option value="expired" {% if form.status.value == 'expired' %}selected{% endif %}>Expired</option>
                    <option value="frozen" {% if form.status.value == 'frozen' %}selected{% endif %}>Frozen</option>
                    <option value="cancelled" {% if form.status.value == 'cancelled' %}selected{% endif %}>Cancelled</option>
                </select>
            </div>
        </div>
    </div>

    <div class="flex items-center gap-3">
        <button type="submit" class="bg-brand-600 hover:bg-brand-700 text-white font-medium px-6 py-2.5 rounded-xl transition-all active:scale-[0.98]">{{ submit_label|default:"Add Member" }}</button>
        <a href="{% url 'frontend:member-list' %}" class="px-6 py-2.5 rounded-xl text-slate-400 hover:text-white border border-slate-700 hover:border-slate-600 transition-all">Cancel</a>
    </div>
</form>
{% endblock %}
